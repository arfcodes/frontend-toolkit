let Q=G;const b={},w=1,E=2,L={owned:null,cleanups:null,context:null,owner:null};var u=null;let x=null,h=null,d=null,r=null,p=null,T=0;function V(e,l){l&&(u=l);const t=h,s=u,i=e.length===0?L:{owned:null,cleanups:null,context:null,owner:s};u=i,h=null;let f;try{N(()=>f=e(()=>B(i)),!0)}finally{h=t,u=s}return f}function m(e,l,t){I(K(e,l,!1,w))}function W(e){if(d)return e();let l;const t=d=[];try{l=e()}finally{d=null}return N(()=>{for(let s=0;s<t.length;s+=1){const i=t[s];if(i.pending!==b){const f=i.pending;i.pending=b,P(i,f)}}},!1),l}function j(e){let l,t=h;return h=null,l=e(),h=t,l}function P(e,l,t){if(e.comparator&&e.comparator(e.value,l))return l;if(d)return e.pending===b&&d.push(e),e.pending=l,l;let s=!1;return e.value=l,e.observers&&e.observers.length&&N(()=>{for(let i=0;i<e.observers.length;i+=1){const f=e.observers[i];s&&x.disposed.has(f),f.pure?r.push(f):p.push(f),f.observers&&(s&&!f.tState||!s&&!f.state)&&O(f),s||(f.state=w)}if(r.length>1e6)throw r=[],new Error},!1),l}function I(e){if(!e.fn)return;B(e);const l=u,t=h,s=T;h=u=e,J(e,e.value,s),h=t,u=l}function J(e,l,t){let s;try{s=e.fn(l)}catch(i){q(i)}(!e.updatedAt||e.updatedAt<=t)&&(e.observers&&e.observers.length?P(e,s):e.value=s,e.updatedAt=t)}function K(e,l,t,s=w,i){const f={fn:e,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:l,owner:u,context:null,pure:t};return u===null||u!==L&&(u.owned?u.owned.push(f):u.owned=[f]),f}function R(e){const l=x;if(e.state!==w)return e.state=0;if(e.suspense&&j(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<T);)(e.state||l)&&t.push(e);for(let s=t.length-1;s>=0;s--)if(e=t[s],e.state===w||l)I(e);else if(e.state===E||l){const i=r;r=null,M(e),r=i}}function N(e,l){if(r)return e();let t=!1;l||(r=[]),p?t=!0:p=[],T++;try{e()}catch(s){q(s)}finally{X(t)}}function X(e){r&&(G(r),r=null),!e&&(p.length?W(()=>{Q(p),p=null}):p=null)}function G(e){for(let l=0;l<e.length;l++)R(e[l])}function M(e){e.state=0;for(let l=0;l<e.sources.length;l+=1){const t=e.sources[l];t.sources&&(t.state===w||x?R(t):t.state===E&&M(t))}}function O(e){const l=x;for(let t=0;t<e.observers.length;t+=1){const s=e.observers[t];(!s.state||l)&&(s.state=E,s.pure?r.push(s):p.push(s),s.observers&&O(s))}}function B(e){let l;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),s=e.sourceSlots.pop(),i=t.observers;if(i&&i.length){const f=i.pop(),n=t.observerSlots.pop();s<i.length&&(f.sourceSlots[n]=s,i[s]=f,t.observerSlots[s]=n)}}if(e.owned){for(l=0;l<e.owned.length;l++)B(e.owned[l]);e.owned=null}if(e.cleanups){for(l=0;l<e.cleanups.length;l++)e.cleanups[l]();e.cleanups=null}e.state=0,e.context=null}function q(e){throw e}function v(e,l,t){let s=t.length,i=l.length,f=s,n=0,o=0,C=l[i-1].nextSibling,g=null;for(;n<i||o<f;){if(l[n]===t[o]){n++,o++;continue}for(;l[i-1]===t[f-1];)i--,f--;if(i===n){const c=f<s?o?t[o-1].nextSibling:t[f-o]:C;for(;o<f;)e.insertBefore(t[o++],c)}else if(f===o)for(;n<i;)(!g||!g.has(l[n]))&&e.removeChild(l[n]),n++;else if(l[n]===t[f-1]&&t[o]===l[i-1]){const c=l[--i].nextSibling;e.insertBefore(t[o++],l[n++].nextSibling),e.insertBefore(t[--f],c),l[i]=t[f]}else{if(!g){g=new Map;let a=o;for(;a<f;)g.set(t[a],a++)}const c=g.get(l[n]);if(c!=null)if(o<c&&c<f){let a=n,S=1,D;for(;++a<i&&a<f&&!((D=g.get(l[a]))==null||D!==c+S);)S++;if(S>c-o){const H=l[n];for(;o<c;)e.insertBefore(t[o++],H)}else e.replaceChild(t[o++],l[n++])}else n++;else e.removeChild(l[n++])}}}function Z(e,l,t){let s;return V(i=>{s=i,Y(l,e(),l.firstChild?null:void 0,t)}),()=>{s(),l.textContent=""}}function _(e,l,t){const s=document.createElement("template");s.innerHTML=e;let i=s.content.firstChild;return t&&(i=i.firstChild),i}function Y(e,l,t,s){if(t!==void 0&&!s&&(s=[]),typeof l!="function")return A(e,l,s,t);m(i=>A(e,l(),i,t),s)}function A(e,l,t,s,i){for(;typeof t=="function";)t=t();if(l===t)return t;const f=typeof l,n=s!==void 0;if(e=n&&t[0]&&t[0].parentNode||e,f==="string"||f==="number")if(f==="number"&&(l=l.toString()),n){let o=t[0];o&&o.nodeType===3?o.data=l:o=document.createTextNode(l),t=y(e,t,s,o)}else t!==""&&typeof t=="string"?t=e.firstChild.data=l:t=e.textContent=l;else if(l==null||f==="boolean")t=y(e,t,s);else{if(f==="function")return m(()=>{let o=l();for(;typeof o=="function";)o=o();t=A(e,o,t,s)}),()=>t;if(Array.isArray(l)){const o=[];if(U(o,l,i))return m(()=>t=A(e,o,t,s,!0)),()=>t;if(o.length===0){if(t=y(e,t,s),n)return t}else Array.isArray(t)?t.length===0?F(e,o,s):v(e,t,o):t==null||t===""?F(e,o):v(e,n&&t||[e.firstChild],o);t=o}else if(l instanceof Node){if(Array.isArray(t)){if(n)return t=y(e,t,s,l);y(e,t,null,l)}else t==null||t===""||!e.firstChild?e.appendChild(l):e.replaceChild(l,e.firstChild);t=l}}return t}function U(e,l,t){let s=!1;for(let i=0,f=l.length;i<f;i++){let n=l[i],o;if(n instanceof Node)e.push(n);else if(!(n==null||n===!0||n===!1))if(Array.isArray(n))s=U(e,n)||s;else if((o=typeof n)==="string")e.push(document.createTextNode(n));else if(o==="function")if(t){for(;typeof n=="function";)n=n();s=U(e,Array.isArray(n)?n:[n])||s}else e.push(n),s=!0;else e.push(document.createTextNode(n.toString()))}return s}function F(e,l,t){for(let s=0,i=l.length;s<i;s++)e.insertBefore(l[s],t)}function y(e,l,t,s){if(t===void 0)return e.textContent="";const i=s||document.createTextNode("");if(l.length){let f=!1;for(let n=l.length-1;n>=0;n--){const o=l[n];if(i!==o){const C=o.parentNode===e;!f&&!n?C?e.replaceChild(i,o):e.insertBefore(i,t):C&&e.removeChild(o)}else f=!0}}else e.insertBefore(i,t);return[i]}export{Z as r,_ as t};
